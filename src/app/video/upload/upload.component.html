<mist-masonry [columns]="screen.currentScreen" [datasets]="uploadForm.controls" [tpl]="cad" #msnry></mist-masonry>
<div align="center" class="choose">
  <button mat-fab (click)="infile.click()" matTooltip="点击选择文件">
    <mat-icon>
      cloud_upload
    </mat-icon>
  </button>
</div>
<input multiple #infile (change)="addFiles(infile.files);msnry.markForDetection()" type="file" accept="video/mp4" style="display: none">
<ng-template let-gForm let-i="index" #cad>
  <mat-card>
    <img mat-card-image [src]="uploadfiles[i].cover">
    <mat-card-content>
      <form [formGroup]="gForm">
        <mat-form-field>
          <textarea matInput placeholder="标题" cdkTextareaAutosize formControlName="title"></textarea>
          <mat-error>标题是必须的</mat-error>
        </mat-form-field>
        <mat-form-field>
          <textarea matInput placeholder="描述" cdkTextareaAutosize formControlName="desc"></textarea>
        </mat-form-field>
      </form>
      <p [style.color]="uploadfiles[i].cover !=='' ? 'green' : 'black'">
        状态: {{uploadfiles[i].msg}}
      </p>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button (click)="removeFile(i);msnry.markForDetection()" [disabled]="uploadfiles[i].cover!==''">删除</button>
      <button mat-button [disabled]="!uploadfiles[i].cover" (click)="setCover(uploadfiles[i].cover)">设为封面</button>
    </mat-card-actions>
    <mat-card-footer>
      <mat-progress-bar mode="determinate" [value]="uploadfiles[i].progress"></mat-progress-bar>
    </mat-card-footer>
  </mat-card>
</ng-template>
