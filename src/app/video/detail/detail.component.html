<mat-sidenav-container>
  <mat-sidenav #sidenav position="end" [mode]="!screen.isMobile ? 'side' : 'over'" [opened]="!screen.isMobile">
    <cdk-virtual-scroll-viewport itemSize="90" class="vscroll">
      <div *cdkVirtualFor="let vid of video.recommend;let i=index" class="recitem" (click)="screen.isMobile ? sidenav.close() : ''">
        <a [routerLink]="['/video', vid.id]"><img [src]="vid.cover"></a>
        <div>
          <div class="title">
            {{vid.title}}
          </div>
          <span class="spacer"></span>
          <div>
            {{vid.date|moment}} · {{vid.view|quantity}} 播放
          </div>
        </div>
      </div>
    </cdk-virtual-scroll-viewport>
  </mat-sidenav>
  <mat-sidenav-content>
    <div class="video">
      <video mistDash controls [src]="video.path" [poster]="video.cover"></video>
      <!-- <ng-template mistP2pvideo [torrent]="video.videos[currentVideo].path" #btclient="p2pVideo">
        <video controls [poster]="video.videos[currentVideo].cover"></video>
      </ng-template>
      <div class="btinfo">
        <span>Peers: {{btclient.getInfo()?.numPeers}}</span>
        <span>下载: {{(btclient.getInfo()?.downloadSpeed | numeric) + '/s'}}</span>
        <span>上传: {{(btclient.getInfo()?.uploadSpeed | numeric) + '/s'}}</span>
      </div> -->
    </div>
    <div class="header">
      <h2>{{video.title}}</h2>
      <span class="spacer"></span>
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>
          playlist_play
        </mat-icon>
      </button>
    </div>
    <div class="header">
      <span>{{video.view}}次观看</span>
      <span class="spacer"></span>
      <button mat-icon-button (click)="like(video, '1')" [style.color]="video.isliked ? 'blue':''">
        <mat-icon>
          thumb_up
        </mat-icon>
      </button>
      <span>{{video.likes}}</span>
    </div>
    <mat-divider></mat-divider>
    <div class="info">
      <div class="avatar" [style.background-image]="'url(' + (video.owner.avatar || 'assets/da.jpg')+')'">
      </div>
      <div>
        <div>{{video.owner.nickName}}</div>
        <div>发布于{{video.date*1000| date:'short'}}</div>
      </div>
      <ng-container *ngIf="video.desc">
        <div></div>
        <div>{{video.desc}}</div>
      </ng-container>
    </div>
    <mat-divider></mat-divider>
    <div>
      <mist-comment [item]="video.id" [type]="'1'"></mist-comment>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
